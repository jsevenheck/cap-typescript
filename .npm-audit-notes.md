# NPM Audit Notes

## Current Vulnerabilities (Transitive Dependencies)

The following vulnerabilities are reported in `npm audit` but are **transitive dependencies from SAP packages** that are outside our direct control:

### 1. axios@1.6.5 (High Severity)
- **Source**: `@sap/audit-logging` → `@sap/xssec` → `axios@1.6.5`
- **Vulnerabilities**: SSRF, Credential Leakage, DoS
- **Mitigation**:
  - Used only internally by SAP audit logging SDK
  - No user-controllable input passed to these axios instances
  - SAP packages maintain their own security updates
  - Added overrides in package.json to force newer versions where possible

### 2. follow-redirects@1.15.4 (Moderate Severity)
- **Source**: `@sap/audit-logging` → `@sap/xssec` → `axios@1.6.5` → `follow-redirects@1.15.4`
- **Vulnerability**: Proxy-Authorization header kept across hosts
- **Mitigation**:
  - Transitive dependency of axios in SAP packages
  - Not directly used in application code
  - Overrides configured to force v1.15.11+

### 3. form-data@4.0.0 (Critical Severity)
- **Source**: `@sap/audit-logging` → `@sap/xssec` → `axios@1.6.5` → `form-data@4.0.0`
- **Vulnerability**: Unsafe random function for boundary selection
- **Mitigation**:
  - Used only by axios for multipart/form-data requests
  - Not used in our application's data flows
  - Overrides configured to force v4.0.4+

### 4. tar@7.5.1 (Moderate Severity)
- **Source**: `@ui5/cli` → `pacote` → `cacache`/`node-gyp` → `tar@7.5.1`
- **Vulnerability**: Race condition leading to uninitialized memory exposure
- **Mitigation**:
  - Build-time only dependency (not in production runtime)
  - Used for package installation, not runtime operations
  - Overrides configured to force v7.5.2+

## Actions Taken

1. **Added npm overrides** in root `package.json`:
   ```json
   "overrides": {
     "axios": "^1.12.2",
     "follow-redirects": "^1.15.11",
     "form-data": "^4.0.4",
     "tar": "^7.5.2"
   }
   ```

2. **Awaiting SAP package updates**: These vulnerabilities will be fully resolved when:
   - SAP updates `@sap/audit-logging` to use newer `@sap/xssec`
   - SAP updates `@sap/xssec` to use `axios` >= 1.12.0
   - UI5 team updates `@ui5/cli` dependencies

## Risk Assessment

**Overall Risk: LOW**

- All vulnerabilities are in transitive dependencies from trusted SAP packages
- Vulnerable code paths are not exposed to user input in our application
- Production runtime does not execute vulnerable UI5 CLI code paths
- SAP maintains active security patching for their packages
- We've added overrides to enforce newer versions where npm allows

## Monitoring

- Run `npm audit` regularly to check for new vulnerabilities
- Monitor SAP release notes for security updates
- Consider upgrading to newer SAP package versions when available

---

**Last Updated**: 2025-11-09
**Review Frequency**: Monthly or on major dependency updates
